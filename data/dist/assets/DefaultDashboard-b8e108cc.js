import{o as i,c as _,w as e,b as t,q as s,v as m,f as p,X as b,Y as l,t as u,H as h,E as r,m as v,D as S,F as w,a5 as c,a6 as O,a7 as M,n as L,p as D,e as j,j as P,l as $,Z as B,g as F}from"./index-11f1cd8c.js";import{_ as T}from"./_plugin-vue_export-helper-c27b6911.js";const I={class:"d-flex align-start mb-3"},N={class:"text-h1 font-weight-medium"},H=s("span",{class:"text-subtitle-1 text-medium-emphasis text-white"},"消息总数",-1),R={name:"TotalMessage",props:["stat"],data:()=>({stat:{message_count:0}}),mounted(){}},E=Object.assign(R,{setup(a){return(n,o)=>(i(),_(r,{elevation:"0",class:"bg-secondary overflow-hidden bubble-shape bubble-secondary-shape"},{default:e(()=>[t(h,null,{default:e(()=>[s("div",I,[t(m,{icon:"",rounded:"sm",color:"darksecondary",variant:"flat"},{default:e(()=>[t(p,{icon:"mdi-account-multiple-outline"})]),_:1})]),t(b,null,{default:e(()=>[t(l,{cols:"6"},{default:e(()=>[s("h2",N,u(a.stat.message_count),1),H]),_:1})]),_:1})]),_:1})]),_:1}))}}),q={class:"d-flex align-start mb-3"},z={class:"text-h1 font-weight-medium"},A=s("span",{class:"text-subtitle-1 text-medium-emphasis text-white"},"消息平台数",-1),U={name:"TotalSession",props:["stat"],data:()=>({stat:{platform_count:0}})},X=Object.assign(U,{setup(a){return(n,o)=>(i(),_(r,{elevation:"0",class:"bg-primary overflow-hidden bubble-shape bubble-primary-shape"},{default:e(()=>[t(h,null,{default:e(()=>[s("div",q,[t(m,{icon:"",rounded:"sm",color:"darkprimary",variant:"flat"},{default:e(()=>[t(p,{icon:"mdi-account-multiple-outline"})]),_:1})]),t(b,null,{default:e(()=>[t(l,{cols:"6"},{default:e(()=>[s("h2",z,u(a.stat.platform_count),1),A]),_:1})]),_:1})]),_:1})]),_:1}))}}),Y={name:"OnlineTime",components:{},props:["stat"],watch:{},data:()=>({stat:{memory:"Loading",running:"Loading"}}),mounted(){}},Z={class:"d-flex align-center gap-3"},G={class:"text-h4 font-weight-medium"},J=s("span",{class:"text-subtitle-2 text-medium-emphasis text-white"},"运行时间",-1),K={class:"d-flex align-center gap-3"},Q={class:"text-h4 font-weight-medium"},W=s("span",{class:"text-subtitle-2 text-disabled font-weight-medium"},"占用内存",-1);function tt(a,n,o,f,d,x){return i(),v(w,null,[t(r,{elevation:"0",class:"bg-primary overflow-hidden bubble-shape-sm bubble-primary mb-6"},{default:e(()=>[t(h,{class:"pa-5"},{default:e(()=>[s("div",Z,[t(m,{color:"darkprimary",icon:"",rounded:"sm",variant:"flat"},{default:e(()=>[t(p,{icon:"mdi-clock"})]),_:1}),s("div",null,[s("h4",G,u(o.stat.running),1),J]),t(S),s("div",null,[t(m,{icon:"",rounded:"sm",variant:"plain"},{default:e(()=>[t(p,{color:"black",icon:"mdi-stop",size:"32"})]),_:1})])])]),_:1})]),_:1}),t(r,{elevation:"0",class:"bubble-shape-sm overflow-hidden bubble-warning"},{default:e(()=>[t(h,{class:"pa-5"},{default:e(()=>{var g,y;return[s("div",K,[t(m,{color:"lightwarning",icon:"",rounded:"sm",variant:"flat"},{default:e(()=>[t(p,{icon:"mdi-memory"})]),_:1}),s("div",null,[s("h4",Q,u((g=o.stat.memory)==null?void 0:g.process)+" / "+u((y=o.stat.memory)==null?void 0:y.system)+" MiB",1),W])])]}),_:1})]),_:1})],64)}const et=T(Y,[["render",tt]]),at=s("span",{class:"text-subtitle-2 text-disabled font-weight-bold"},"总消息趋势",-1),st={class:"mt-4"},nt={name:"MessageStat",components:{},props:["stat"],data:()=>({total_cnt:0,select:{state:"Today",abbr:"FL"},items:[{state:"过去 1 天",abbr:"FL"}],chartOptions1:{chart:{type:"area",height:400,fontFamily:"inherit",foreColor:"#a1aab2"},colors:["#5e35b1"],dataLabels:{enabled:!1},stroke:{curve:"smooth",width:1},tooltip:{fixed:{enabled:!1},x:{show:!0,format:"yyyy-MM-dd HH:mm"},y:{title:{formatter:()=>"消息条数 "}}},xaxis:{type:"datetime",title:{text:"时间"},labels:{formatter:function(a){return new Date(a).toLocaleString()}}},yaxis:{title:{text:"消息条数"}},grid:{show:!0}},lineChart1:{series:[{name:"消息条数",data:[]}]}}),watch:{stat:{handler:function(a,n){a=a.message_time_series,this.lineChart1.series[0].data=a.map(o=>[new Date(o[0]*1e3).getTime(),o[1]])},deep:!0}}},ot=Object.assign(nt,{setup(a){return(n,o)=>{const f=c("apexchart");return i(),_(r,{elevation:"0"},{default:e(()=>[t(r,{variant:"outlined"},{default:e(()=>[t(h,null,{default:e(()=>[t(b,null,{default:e(()=>[t(l,{cols:"12",sm:"7"},{default:e(()=>[at]),_:1}),t(l,{cols:"12",sm:"5"},{default:e(()=>[t(O,{color:"primary",variant:"outlined","hide-details":"",modelValue:n.select,"onUpdate:modelValue":o[0]||(o[0]=d=>n.select=d),items:n.items,"item-title":"state","item-value":"abbr",label:"Select","persistent-hint":"","return-object":"","single-line":""},null,8,["modelValue","items"])]),_:1})]),_:1}),s("div",st,[t(f,{type:"area",height:"280",options:n.chartOptions1,series:n.lineChart1.series,ref:"rtchart"},null,8,["options","series"])])]),_:1})]),_:1})]),_:1})}}}),lt=s("div",{class:"d-flex align-center"},[s("h4",{class:"text-h4 mt-1"},"各平台消息数")],-1),it={class:"mt-4"},rt={class:"d-inline-flex align-center justify-space-between w-100"},dt={class:"text-subtitle-1 text-medium-emphasis font-weight-bold"},ct={class:"ml-auto text-subtitle-1 text-medium-emphasis font-weight-bold"},ut={class:"text-center mt-3"},mt={name:"PlatformStat",components:{},props:["stat"],watch:{stat:{handler:function(a,n){this.platforms=a.platform},deep:!0}},data:()=>({platforms:[]}),mounted(){}},_t=Object.assign(mt,{setup(a){return M(()=>({chart:{type:"area",height:95,fontFamily:"inherit",foreColor:"#a1aab2",sparkline:{enabled:!0}},colors:["#5e35b1"],dataLabels:{enabled:!1},stroke:{curve:"smooth",width:1},tooltip:{theme:"dark",fixed:{enabled:!1},x:{show:!1},y:{title:{formatter:()=>"消息条数 "}},marker:{show:!1}}})),(n,o)=>{const f=c("ChevronRightIcon");return i(),_(r,{elevation:"0"},{default:e(()=>[t(r,{variant:"outlined"},{default:e(()=>[t(h,null,{default:e(()=>[lt,s("div",it,[t(L,{lines:"two",class:"py-0",style:{height:"270px"}},{default:e(()=>[(i(!0),v(w,null,D(n.platforms,(d,x)=>(i(),_(P,{key:x,value:d,color:"secondary",rounded:"sm"},{default:e(()=>[s("div",rt,[s("div",null,[s("h6",dt,u(d.name),1)]),s("div",ct,u(d.count)+" 条",1)])]),_:2},1032,["value"]))),128))]),_:1}),s("div",ut,[t(m,{color:"primary",variant:"text"},{append:e(()=>[t(f,{"stroke-width":"1.5",width:"20"})]),default:e(()=>[j("详情 ")]),_:1})])])]),_:1})]),_:1})]),_:1})}}}),ht={name:"DefaultDashboard",components:{TotalMessage:E,OnlinePlatform:X,OnlineTime:et,MessageStat:ot,PlatformStat:_t},data:()=>({stat:{},noticeTitle:"",noticeContent:"",noticeType:""}),mounted(){$.get("/api/stat/get").then(a=>{this.stat=a.data.data}),$.get("https://api.soulter.top/astrbot-announcement").then(a=>{let n=a.data.data;n["dashboard-notice"]&&(this.noticeTitle=n["dashboard-notice"].title,this.noticeContent=n["dashboard-notice"].content,this.noticeType=n["dashboard-notice"].type)})}};function ft(a,n,o,f,d,x){const g=c("TotalMessage"),y=c("OnlinePlatform"),V=c("OnlineTime"),C=c("MessageStat"),k=c("PlatformStat");return i(),v(w,null,[t(b,{style:{margin:"2px"}},{default:e(()=>[a.noticeTitle&&a.noticeContent?(i(),_(B,{key:0,type:a.noticeType,text:a.noticeContent,title:a.noticeTitle,closable:""},null,8,["type","text","title"])):F("",!0)]),_:1}),t(b,null,{default:e(()=>[t(l,{cols:"12",md:"4"},{default:e(()=>[t(g,{stat:a.stat},null,8,["stat"])]),_:1}),t(l,{cols:"12",md:"4"},{default:e(()=>[t(y,{stat:a.stat},null,8,["stat"])]),_:1}),t(l,{cols:"12",md:"4"},{default:e(()=>[t(V,{stat:a.stat},null,8,["stat"])]),_:1}),t(l,{cols:"12",lg:"8"},{default:e(()=>[t(C,{stat:a.stat},null,8,["stat"])]),_:1}),t(l,{cols:"12",lg:"4"},{default:e(()=>[t(k,{stat:a.stat},null,8,["stat"])]),_:1})]),_:1})],64)}const gt=T(ht,[["render",ft]]);export{gt as default};
